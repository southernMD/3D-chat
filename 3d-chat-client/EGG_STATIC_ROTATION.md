# å½©è›‹é™æ€æ—‹è½¬ - å›ºå®šéšæœºè§’åº¦

## æ¦‚è¿°
è¿›ä¸€æ­¥ç®€åŒ–å½©è›‹ç³»ç»Ÿï¼Œç§»é™¤æ—‹è½¬åŠ¨ç”»ï¼Œæ”¹ä¸ºåœ¨åˆ›å»ºæ—¶è®¾ç½®ä¸€ä¸ªå›ºå®šçš„éšæœºæ—‹è½¬è§’åº¦ï¼Œè®©æ¯ä¸ªé¸¡è›‹éƒ½æœ‰ä¸åŒçš„æœå‘ä½†ä¿æŒé™æ­¢ã€‚

## ä¿®æ”¹å†…å®¹

### ç§»é™¤çš„åŠŸèƒ½
- âŒ æ—‹è½¬åŠ¨ç”»å¾ªç¯
- âŒ requestAnimationFrame è°ƒç”¨
- âŒ åŠ¨ç”»å‡½æ•°å¼•ç”¨ç®¡ç†
- âŒ eggAnimations Map å­˜å‚¨

### ä¿ç•™çš„åŠŸèƒ½
- âœ… çœŸå®3Dé¸¡è›‹æ¨¡å‹
- âœ… éšæœºæ—‹è½¬è§’åº¦ï¼ˆä¸€æ¬¡æ€§è®¾ç½®ï¼‰
- âœ… åŸºæœ¬èµ„æºç®¡ç†

## æ ¸å¿ƒå®ç°

### 1. é™æ€éšæœºæ—‹è½¬
```typescript
// è®¾ç½®éšæœºæ—‹è½¬è§’åº¦ï¼ˆä¸€æ¬¡æ€§ï¼‰
eggModel.rotation.x = Math.random() * Math.PI * 2 // 0 åˆ° 2Ï€
eggModel.rotation.y = Math.random() * Math.PI * 2
eggModel.rotation.z = Math.random() * Math.PI * 2
```

### 2. ç®€åŒ–çš„æ•°æ®ç»“æ„
```typescript
// åªéœ€è¦å­˜å‚¨é¸¡è›‹æ¨¡å‹
private eggs: Map<string, THREE.Object3D> = new Map()

// ä¸å†éœ€è¦åŠ¨ç”»ç®¡ç†
// private eggAnimations: Map<string, () => void> = new Map() // å·²ç§»é™¤
```

### 3. ç®€åŒ–çš„æ¸…ç†é€»è¾‘
```typescript
clearEgg(eggId: string): boolean {
  const eggModel = this.eggs.get(eggId)
  if (eggModel) {
    this.scene.remove(eggModel)
    // æ¸…ç†èµ„æº...
    this.eggs.delete(eggId)
    // ä¸å†éœ€è¦æ¸…ç†åŠ¨ç”»å¼•ç”¨
  }
}
```

## æŠ€æœ¯ç‰¹ç‚¹

### 1. é›¶åŠ¨ç”»å¼€é”€
- **æ— åŠ¨ç”»å¾ªç¯**ï¼šä¸ä½¿ç”¨ requestAnimationFrame
- **æ— è®¡ç®—å¼€é”€**ï¼šæ—‹è½¬è§’åº¦åªè®¡ç®—ä¸€æ¬¡
- **æ— å†…å­˜å ç”¨**ï¼šä¸å­˜å‚¨åŠ¨ç”»å‡½æ•°å¼•ç”¨

### 2. éšæœºæ€§ä¿æŒ
- **Xè½´æ—‹è½¬**ï¼š0 åˆ° 360åº¦éšæœº
- **Yè½´æ—‹è½¬**ï¼š0 åˆ° 360åº¦éšæœº  
- **Zè½´æ—‹è½¬**ï¼š0 åˆ° 360åº¦éšæœº
- **æ¯ä¸ªé¸¡è›‹**ï¼šéƒ½æœ‰ç‹¬ç‰¹çš„æœå‘

### 3. æç®€å®ç°
```typescript
private insertEggIntoScene(id: string, x: number, y: number, z: number) {
  // è·å–æ¨¡å‹
  const eggModel = Egg.getEggInstance()
  
  // è®¾ç½®å±æ€§
  eggModel.name = `egg_${id}`
  eggModel.position.set(x, y, z)
  
  // ä¸€æ¬¡æ€§éšæœºæ—‹è½¬
  eggModel.rotation.x = Math.random() * Math.PI * 2
  eggModel.rotation.y = Math.random() * Math.PI * 2
  eggModel.rotation.z = Math.random() * Math.PI * 2
  
  // æ·»åŠ åˆ°åœºæ™¯
  this.scene.add(eggModel)
  this.eggs.set(id, eggModel)
}
```

## æ€§èƒ½ä¼˜åŠ¿

### 1. CPUä½¿ç”¨
- **é›¶åŠ¨ç”»è®¡ç®—**ï¼šä¸éœ€è¦æ¯å¸§è®¡ç®—æ—‹è½¬
- **ä¸€æ¬¡æ€§è®¾ç½®**ï¼šåªåœ¨åˆ›å»ºæ—¶è®¡ç®—è§’åº¦
- **æ— å¾ªç¯å¼€é”€**ï¼šä¸å ç”¨åŠ¨ç”»å¾ªç¯èµ„æº

### 2. å†…å­˜ä½¿ç”¨
- **æœ€å°å­˜å‚¨**ï¼šåªå­˜å‚¨é¸¡è›‹æ¨¡å‹å¼•ç”¨
- **æ— å‡½æ•°å¼•ç”¨**ï¼šä¸å­˜å‚¨åŠ¨ç”»å‡½æ•°
- **ç®€å•ç»“æ„**ï¼šæœ€ç®€åŒ–çš„æ•°æ®ç»“æ„

### 3. æ¸²æŸ“æ€§èƒ½
- **é™æ€å¯¹è±¡**ï¼šæ¸²æŸ“å¼•æ“å¯ä»¥ä¼˜åŒ–é™æ€ç‰©ä½“
- **æ— å˜æ¢è®¡ç®—**ï¼šä¸éœ€è¦æ¯å¸§æ›´æ–°å˜æ¢çŸ©é˜µ
- **æ‰¹é‡æ¸²æŸ“**ï¼šå¯èƒ½è¢«å¼•æ“æ‰¹é‡å¤„ç†

## è§†è§‰æ•ˆæœ

### 1. è‡ªç„¶éšæœº
- **å¤šæ ·æœå‘**ï¼šæ¯ä¸ªé¸¡è›‹éƒ½æœ‰ä¸åŒçš„è§’åº¦
- **è‡ªç„¶åˆ†å¸ƒ**ï¼šéšæœºè§’åº¦çœ‹èµ·æ¥å¾ˆè‡ªç„¶
- **é™æ€ç¨³å®š**ï¼šä¸ä¼šå› ä¸ºåŠ¨ç”»è€Œåˆ†æ•£æ³¨æ„åŠ›

### 2. ä¸€è‡´æ€§
- **å›ºå®šæœå‘**ï¼šé¸¡è›‹åˆ›å»ºåæœå‘ä¸å˜
- **å¯é¢„æµ‹æ€§**ï¼šç©å®¶å¯ä»¥è®°ä½é¸¡è›‹çš„ä½ç½®å’Œæœå‘
- **ç¨³å®šè§†è§‰**ï¼šä¸ä¼šæœ‰åŠ¨ç”»å¹²æ‰°

## ä½¿ç”¨åœºæ™¯

### 1. æ€§èƒ½æ•æ„Ÿç¯å¢ƒ
- ä½ç«¯è®¾å¤‡
- å¤§é‡å½©è›‹åœºæ™¯
- é•¿æ—¶é—´è¿è¡Œåº”ç”¨

### 2. é™æ€åœºæ™¯è®¾è®¡
- éœ€è¦ç¨³å®šè§†è§‰çš„åœºæ™¯
- ä¸“æ³¨äºå…¶ä»–åŠ¨ç”»å…ƒç´ 
- å‡å°‘è§†è§‰å¹²æ‰°

### 3. ç®€çº¦é£æ ¼
- æç®€ä¸»ä¹‰è®¾è®¡
- ä¸“æ³¨æ¸¸æˆæ ¸å¿ƒç©æ³•
- æ¸…çˆ½çš„è§†è§‰ä½“éªŒ

## æ‰©å±•å¯èƒ½æ€§

### 1. é¢„è®¾è§’åº¦
```typescript
// å¯ä»¥ä½¿ç”¨é¢„è®¾çš„ç¾è§‚è§’åº¦
const presetRotations = [
  { x: 0, y: 0, z: 0 },
  { x: Math.PI/4, y: Math.PI/4, z: 0 },
  { x: 0, y: Math.PI/2, z: Math.PI/4 }
]
const rotation = presetRotations[Math.floor(Math.random() * presetRotations.length)]
```

### 2. åŸºäºä½ç½®çš„æ—‹è½¬
```typescript
// æ ¹æ®ä½ç½®è®¡ç®—æ—‹è½¬è§’åº¦
eggModel.rotation.y = Math.atan2(z, x) // æœå‘ä¸­å¿ƒ
```

### 3. åˆ†ç»„æ—‹è½¬
```typescript
// ç›¸åŒç±»å‹çš„é¸¡è›‹ä½¿ç”¨ç›¸ä¼¼çš„æ—‹è½¬
const baseRotation = Math.random() * Math.PI * 2
eggModel.rotation.y = baseRotation + (Math.random() - 0.5) * 0.5
```

## å¯¹æ¯”æ€»ç»“

### åŠ¨ç”»ç‰ˆæœ¬
- ğŸ”´ æŒç»­çš„CPUè®¡ç®—
- ğŸ”´ åŠ¨ç”»å‡½æ•°ç®¡ç†
- ğŸ”´ å†…å­˜å ç”¨è¾ƒå¤§
- ğŸŸ¡ åŠ¨æ€è§†è§‰æ•ˆæœ

### é™æ€ç‰ˆæœ¬
- ğŸŸ¢ é›¶åŠ¨ç”»å¼€é”€
- ğŸŸ¢ æç®€æ•°æ®ç»“æ„
- ğŸŸ¢ æœ€å°å†…å­˜å ç”¨
- ğŸŸ¢ ç¨³å®šè§†è§‰æ•ˆæœ
- ğŸŸ¢ é«˜æ€§èƒ½è¡¨ç°

## ä»£ç å¯¹æ¯”

### ä¿®æ”¹å‰ï¼ˆåŠ¨ç”»ç‰ˆæœ¬ï¼‰
```typescript
// å¤æ‚çš„åŠ¨ç”»ç³»ç»Ÿ
const rotationSpeed = { x: ..., y: ..., z: ... }
const animate = () => {
  eggModel.rotation.x += rotationSpeed.x
  // ...
  requestAnimationFrame(animate)
}
this.eggAnimations.set(id, animate)
```

### ä¿®æ”¹åï¼ˆé™æ€ç‰ˆæœ¬ï¼‰
```typescript
// ç®€å•çš„ä¸€æ¬¡æ€§è®¾ç½®
eggModel.rotation.x = Math.random() * Math.PI * 2
eggModel.rotation.y = Math.random() * Math.PI * 2
eggModel.rotation.z = Math.random() * Math.PI * 2
```

ç°åœ¨å½©è›‹ç³»ç»Ÿè¾¾åˆ°äº†æœ€ç®€åŒ–çŠ¶æ€ï¼šçº¯å‡€çš„3Dé¸¡è›‹æ¨¡å‹ï¼Œæ¯ä¸ªéƒ½æœ‰éšæœºä½†å›ºå®šçš„æ—‹è½¬è§’åº¦ï¼ğŸ¥šğŸ“
